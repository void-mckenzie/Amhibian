{'epochs': 20, 'batch_size': 1, 'ft_shots': 15, 'lr': 0.001, 'wd': 3e-05, 'loss_type': 'iou', 'scheduler': None, 'scheduler_params': None, 'norm_type': 'instance', 'volumetric': False, 'max_images': None, 'data_regime': 'all'}
Starting fine-tuning
Save path None
/scratch2/mganesh/MetaMedSeg/MetaMedSeg/splits/spleen
Using iou
Creating data loaders for fine-tuning
Training on all train data
Loaded pre-trained meta-model
Epoch 0
Learning rate 0.001000
Mean train iou loss for epoch 0: 0.6095
Mean train IoU for epoch 0: 0.4210
Mean validation iou loss in epoch 0: 0.4281
Mean validation IoU in epoch 0: 0.5998
Epoch completed in 0.97 minutes. Remaining time (approx): 19.43 minutes
Epoch 1
Learning rate 0.001000
Mean train iou loss for epoch 1: 0.3119
Mean train IoU for epoch 1: 0.7072
Epoch completed in 0.73 minutes. Remaining time (approx): 13.93 minutes
Epoch 2
Learning rate 0.001000
Mean train iou loss for epoch 2: 0.2269
Mean train IoU for epoch 2: 0.7863
Mean validation iou loss in epoch 2: 0.2269
Mean validation IoU in epoch 2: 0.7850
Epoch completed in 0.83 minutes. Remaining time (approx): 14.95 minutes
Epoch 3
Learning rate 0.001000
Mean train iou loss for epoch 3: 0.1866
Mean train IoU for epoch 3: 0.8242
Epoch completed in 0.85 minutes. Remaining time (approx): 14.46 minutes
Epoch 4
Learning rate 0.001000
Mean train iou loss for epoch 4: 0.1565
Mean train IoU for epoch 4: 0.8524
Mean validation iou loss in epoch 4: 0.2051
Mean validation IoU in epoch 4: 0.8007
Epoch completed in 0.80 minutes. Remaining time (approx): 12.81 minutes
Epoch 5
Learning rate 0.001000
Mean train iou loss for epoch 5: 0.1454
Mean train IoU for epoch 5: 0.8625
Epoch completed in 0.86 minutes. Remaining time (approx): 12.86 minutes
Epoch 6
Learning rate 0.001000
Mean train iou loss for epoch 6: 0.1270
Mean train IoU for epoch 6: 0.8793
Mean validation iou loss in epoch 6: 0.1669
Mean validation IoU in epoch 6: 0.8386
Epoch completed in 0.93 minutes. Remaining time (approx): 13.08 minutes
Epoch 7
Learning rate 0.001000
Mean train iou loss for epoch 7: 0.1176
Mean train IoU for epoch 7: 0.8885
Epoch completed in 0.89 minutes. Remaining time (approx): 11.53 minutes
Epoch 8
Learning rate 0.001000
Mean train iou loss for epoch 8: 0.1091
Mean train IoU for epoch 8: 0.8960
Mean validation iou loss in epoch 8: 0.1486
Mean validation IoU in epoch 8: 0.8576
Epoch completed in 0.95 minutes. Remaining time (approx): 11.45 minutes
Epoch 9
Learning rate 0.001000
Mean train iou loss for epoch 9: 0.1003
Mean train IoU for epoch 9: 0.9043
Epoch completed in 0.90 minutes. Remaining time (approx): 9.95 minutes
Epoch 10
Learning rate 0.001000
Mean train iou loss for epoch 10: 0.0956
Mean train IoU for epoch 10: 0.9091
Mean validation iou loss in epoch 10: 0.1098
Mean validation IoU in epoch 10: 0.8939
Epoch completed in 0.88 minutes. Remaining time (approx): 8.85 minutes
Epoch 11
Learning rate 0.001000
Mean train iou loss for epoch 11: 0.0926
Mean train IoU for epoch 11: 0.9114
Epoch completed in 0.69 minutes. Remaining time (approx): 6.24 minutes
Epoch 12
Learning rate 0.001000
Mean train iou loss for epoch 12: 0.0926
Mean train IoU for epoch 12: 0.9112
Mean validation iou loss in epoch 12: 0.1704
Mean validation IoU in epoch 12: 0.8367
Epoch completed in 0.90 minutes. Remaining time (approx): 7.18 minutes
Epoch 13
Learning rate 0.001000
Mean train iou loss for epoch 13: 0.0904
Mean train IoU for epoch 13: 0.9134
Epoch completed in 0.92 minutes. Remaining time (approx): 6.45 minutes
Epoch 14
Learning rate 0.001000
Mean train iou loss for epoch 14: 0.0889
Mean train IoU for epoch 14: 0.9144
Mean validation iou loss in epoch 14: 0.1199
Mean validation IoU in epoch 14: 0.8839
Epoch completed in 1.03 minutes. Remaining time (approx): 6.21 minutes
Epoch 15
Learning rate 0.001000
Mean train iou loss for epoch 15: 0.0862
Mean train IoU for epoch 15: 0.9169
Epoch completed in 0.88 minutes. Remaining time (approx): 4.39 minutes
Epoch 16
Learning rate 0.001000
Mean train iou loss for epoch 16: 0.0819
Mean train IoU for epoch 16: 0.9210
Mean validation iou loss in epoch 16: 0.1122
Mean validation IoU in epoch 16: 0.8934
Epoch completed in 0.84 minutes. Remaining time (approx): 3.36 minutes
Epoch 17
Learning rate 0.001000
Mean train iou loss for epoch 17: 0.0772
Mean train IoU for epoch 17: 0.9255
Epoch completed in 0.86 minutes. Remaining time (approx): 2.58 minutes
Epoch 18
Learning rate 0.001000
Mean train iou loss for epoch 18: 0.0828
Mean train IoU for epoch 18: 0.9198
Mean validation iou loss in epoch 18: 0.1612
Mean validation IoU in epoch 18: 0.8427
Epoch completed in 0.93 minutes. Remaining time (approx): 1.86 minutes
Epoch 19
Learning rate 0.001000
Mean train iou loss for epoch 19: 0.0878
Mean train IoU for epoch 19: 0.9153
Mean validation iou loss in epoch 19: 0.1556
Mean validation IoU in epoch 19: 0.8504
Epoch completed in 0.86 minutes. Remaining time (approx): 0.86 minutes
Test iou loss: 0.14012662922670394
Test IoU: 0.864490807056427
Fine_tuning completed in 1059.0584138869308 seconds.
                                             weights  ...              test_iou_all
0        experiments/weights_nonvolumetric_plain.pth  ...      [0.8712103366851807]
1        experiments/weights_nonvolumetric_plain.pth  ...  [1.4173585327625915e-07]
2      experiments/weights_nonvolumetric_attunet.pth  ...      [0.6389144062995911]
3   experiments/weights_nonvolumetric_plain_dice.pth  ...      [0.8750856518745422]
4  experiments/weights_nonvolumetric_attunet_dice...  ...      [0.2238553762435913]
5  experiments/weights_nonvolumetric_plain_iou_am...  ...       [0.864490807056427]
[6 rows x 23 columns]