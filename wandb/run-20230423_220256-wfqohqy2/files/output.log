['heart']
It is none
None
Starting meta-learning
Using iou
OUTER EPOCH 0
Dataset 11, hippocampus_anterior
Inner Epoch 0
Learning rate 0.010000
Mean train iou loss for epoch 0: 0.9045
Mean train IoU for epoch 0: 0.1075
Inner Epoch 1
Learning rate 0.008000
Mean train iou loss for epoch 1: 0.8873
Mean train IoU for epoch 1: 0.1164
Inner Epoch 2
Learning rate 0.006400
Mean train iou loss for epoch 2: 0.8592
Mean train IoU for epoch 2: 0.1455
Inner Epoch 3
Learning rate 0.005120
Mean train iou loss for epoch 3: 0.8530
Mean train IoU for epoch 3: 0.1482
Inner Epoch 4
Learning rate 0.004096
Mean train iou loss for epoch 4: 0.8304
Mean train IoU for epoch 4: 0.1740
Inner Epoch 5
Learning rate 0.003277
Mean train iou loss for epoch 5: 0.8203
Mean train IoU for epoch 5: 0.1841
Inner Epoch 6
Learning rate 0.002621
Mean train iou loss for epoch 6: 0.8105
Mean train IoU for epoch 6: 0.1930
Inner Epoch 7
Learning rate 0.002097
Mean train iou loss for epoch 7: 0.8026
Mean train IoU for epoch 7: 0.2028
Inner Epoch 8
Learning rate 0.001678
Mean train iou loss for epoch 8: 0.7928
Mean train IoU for epoch 8: 0.2132
Inner Epoch 9
Learning rate 0.001342
Mean train iou loss for epoch 9: 0.7824
Mean train IoU for epoch 9: 0.2265
Inner Epoch 10
Learning rate 0.001074
Mean train iou loss for epoch 10: 0.7748
Mean train IoU for epoch 10: 0.2349
Inner Epoch 11
Learning rate 0.000859
Mean train iou loss for epoch 11: 0.7603
Mean train IoU for epoch 11: 0.2548
Inner Epoch 12
Learning rate 0.000687
Mean train iou loss for epoch 12: 0.7450
Mean train IoU for epoch 12: 0.2764
Inner Epoch 13
Learning rate 0.000550
Mean train iou loss for epoch 13: 0.7414
Mean train IoU for epoch 13: 0.2768
Inner Epoch 14
Learning rate 0.000440
Mean train iou loss for epoch 14: 0.7167
Mean train IoU for epoch 14: 0.3081
Inner Epoch 15
Learning rate 0.000352
Mean train iou loss for epoch 15: 0.6793
Mean train IoU for epoch 15: 0.3623
Inner Epoch 16
Learning rate 0.000281
Mean train iou loss for epoch 16: 0.7411
Mean train IoU for epoch 16: 0.2962
Inner Epoch 17
Learning rate 0.000225
Mean train iou loss for epoch 17: 0.6849
Mean train IoU for epoch 17: 0.3468
Inner Epoch 18
Learning rate 0.000180
Mean train iou loss for epoch 18: 0.6907
Mean train IoU for epoch 18: 0.3369
Inner Epoch 19
Learning rate 0.000144
Mean train iou loss for epoch 19: 0.6879
Mean train IoU for epoch 19: 0.3393
Validating... on val dataset: 5 shots
Val loss: 0.7737, val IoU: 0.2264
Dataset 0, pancreas_cancer
Inner Epoch 0
Learning rate 0.010000
Mean train iou loss for epoch 0: 0.9891
Mean train IoU for epoch 0: 0.0009
Inner Epoch 1
Learning rate 0.008000
Mean train iou loss for epoch 1: 0.9833
Mean train IoU for epoch 1: 0.0171
Inner Epoch 2
Learning rate 0.006400
Mean train iou loss for epoch 2: 0.9800
Mean train IoU for epoch 2: 0.0222
Inner Epoch 3
Learning rate 0.005120
Mean train iou loss for epoch 3: 0.9766
Mean train IoU for epoch 3: 0.0240
Inner Epoch 4
Learning rate 0.004096
Mean train iou loss for epoch 4: 0.9732
Mean train IoU for epoch 4: 0.0262
Inner Epoch 5
Learning rate 0.003277
Mean train iou loss for epoch 5: 0.9684
Mean train IoU for epoch 5: 0.0320
Inner Epoch 6
Learning rate 0.002621
Mean train iou loss for epoch 6: 0.9602
Mean train IoU for epoch 6: 0.0504
Inner Epoch 7
Learning rate 0.002097
Mean train iou loss for epoch 7: 0.9543
Mean train IoU for epoch 7: 0.0569
Inner Epoch 8
Learning rate 0.001678
Mean train iou loss for epoch 8: 0.9497
Mean train IoU for epoch 8: 0.0517
Inner Epoch 9
Learning rate 0.001342
Mean train iou loss for epoch 9: 0.9466
Mean train IoU for epoch 9: 0.0521
Inner Epoch 10
Learning rate 0.001074
Mean train iou loss for epoch 10: 0.9406
Mean train IoU for epoch 10: 0.0580
Inner Epoch 11
Learning rate 0.000859
Mean train iou loss for epoch 11: 0.9199
Mean train IoU for epoch 11: 0.0973
Inner Epoch 12
Learning rate 0.000687
Mean train iou loss for epoch 12: 0.9017
Mean train IoU for epoch 12: 0.1348
Inner Epoch 13
Learning rate 0.000550
Mean train iou loss for epoch 13: 0.9334
Mean train IoU for epoch 13: 0.0965
Inner Epoch 14
Learning rate 0.000440
Mean train iou loss for epoch 14: 0.8922
Mean train IoU for epoch 14: 0.1509
Inner Epoch 15
Learning rate 0.000352
Mean train iou loss for epoch 15: 0.8987
Mean train IoU for epoch 15: 0.1258
Inner Epoch 16
Learning rate 0.000281
Mean train iou loss for epoch 16: 0.8946
Mean train IoU for epoch 16: 0.1465
Inner Epoch 17
Learning rate 0.000225
Mean train iou loss for epoch 17: 0.8867
Mean train IoU for epoch 17: 0.1641
Inner Epoch 18
Learning rate 0.000180
Mean train iou loss for epoch 18: 0.8768
Mean train IoU for epoch 18: 0.1781
Inner Epoch 19
Learning rate 0.000144
Mean train iou loss for epoch 19: 0.8595
Mean train IoU for epoch 19: 0.2093
Validating... on val dataset: 5 shots
Val loss: 0.8821, val IoU: 0.1305
Dataset 11, hippocampus_anterior
Inner Epoch 0
Learning rate 0.010000
Mean train iou loss for epoch 0: 0.9001
Mean train IoU for epoch 0: 0.1072
Inner Epoch 1
Learning rate 0.008000
Mean train iou loss for epoch 1: 0.8812
Mean train IoU for epoch 1: 0.1222
Inner Epoch 2
Learning rate 0.006400
Mean train iou loss for epoch 2: 0.8546
Mean train IoU for epoch 2: 0.1489
Inner Epoch 3
Learning rate 0.005120
Mean train iou loss for epoch 3: 0.8364
Mean train IoU for epoch 3: 0.1695
Inner Epoch 4
Learning rate 0.004096
Mean train iou loss for epoch 4: 0.8190
Mean train IoU for epoch 4: 0.1856
Inner Epoch 5
Learning rate 0.003277
Mean train iou loss for epoch 5: 0.8059
Mean train IoU for epoch 5: 0.1979
Inner Epoch 6
Learning rate 0.002621
Mean train iou loss for epoch 6: 0.7926
Mean train IoU for epoch 6: 0.2123
Inner Epoch 7
Learning rate 0.002097
Mean train iou loss for epoch 7: 0.7791
Mean train IoU for epoch 7: 0.2289
Inner Epoch 8
Learning rate 0.001678
Mean train iou loss for epoch 8: 0.7638
Mean train IoU for epoch 8: 0.2483
Inner Epoch 9
Learning rate 0.001342
Mean train iou loss for epoch 9: 0.7775
Mean train IoU for epoch 9: 0.2311
Inner Epoch 10
Learning rate 0.001074
Mean train iou loss for epoch 10: 0.7497
Mean train IoU for epoch 10: 0.2569
Inner Epoch 11
Learning rate 0.000859
Mean train iou loss for epoch 11: 0.7288
Mean train IoU for epoch 11: 0.2798
Inner Epoch 12
Learning rate 0.000687
Mean train iou loss for epoch 12: 0.7005
Mean train IoU for epoch 12: 0.3156
Inner Epoch 13
Learning rate 0.000550
Mean train iou loss for epoch 13: 0.6758
Mean train IoU for epoch 13: 0.3410
Inner Epoch 14
Learning rate 0.000440
Mean train iou loss for epoch 14: 0.6422
Mean train IoU for epoch 14: 0.3728
Inner Epoch 15
Learning rate 0.000352
Mean train iou loss for epoch 15: 0.6029
Mean train IoU for epoch 15: 0.4171
Inner Epoch 16
Learning rate 0.000281
Mean train iou loss for epoch 16: 0.5587
Mean train IoU for epoch 16: 0.4550
Inner Epoch 17
Learning rate 0.000225
Mean train iou loss for epoch 17: 0.5244
Mean train IoU for epoch 17: 0.4988
Inner Epoch 18
Learning rate 0.000180
Mean train iou loss for epoch 18: 0.4890
Mean train IoU for epoch 18: 0.5342
Inner Epoch 19
Learning rate 0.000144
Mean train iou loss for epoch 19: 0.4580
Mean train IoU for epoch 19: 0.5692
Validating... on val dataset: 5 shots
Val loss: 0.5057, val IoU: 0.5289
Dataset 14, vessel
Inner Epoch 0
Learning rate 0.010000
Mean train iou loss for epoch 0: 0.9953
Mean train IoU for epoch 0: 0.0002
Inner Epoch 1
Learning rate 0.008000
Mean train iou loss for epoch 1: 0.9934
Mean train IoU for epoch 1: 0.0065
Inner Epoch 2
Learning rate 0.006400
Mean train iou loss for epoch 2: 0.9908
Mean train IoU for epoch 2: 0.0117
Inner Epoch 3
Learning rate 0.005120
Mean train iou loss for epoch 3: 0.9888
Mean train IoU for epoch 3: 0.0138
Inner Epoch 4
Learning rate 0.004096
Mean train iou loss for epoch 4: 0.9853
Mean train IoU for epoch 4: 0.0228
Inner Epoch 5
Learning rate 0.003277
Mean train iou loss for epoch 5: 0.9817
Mean train IoU for epoch 5: 0.0294
Inner Epoch 6
Learning rate 0.002621
Mean train iou loss for epoch 6: 0.9775
Mean train IoU for epoch 6: 0.0365
Inner Epoch 7
Learning rate 0.002097
Mean train iou loss for epoch 7: 0.9730
Mean train IoU for epoch 7: 0.0421
Inner Epoch 8
Learning rate 0.001678
Mean train iou loss for epoch 8: 0.9694
Mean train IoU for epoch 8: 0.0488
Inner Epoch 9
Learning rate 0.001342
Mean train iou loss for epoch 9: 0.9648
Mean train IoU for epoch 9: 0.0480
Inner Epoch 10
Learning rate 0.001074
Mean train iou loss for epoch 10: 0.9596
Mean train IoU for epoch 10: 0.0717
Inner Epoch 11
Learning rate 0.000859
Mean train iou loss for epoch 11: 0.9725
Mean train IoU for epoch 11: 0.0345
Inner Epoch 12
Learning rate 0.000687
Mean train iou loss for epoch 12: 0.9562
Mean train IoU for epoch 12: 0.0637
Inner Epoch 13
Learning rate 0.000550
Mean train iou loss for epoch 13: 0.9547
Mean train IoU for epoch 13: 0.0656
Inner Epoch 14
Learning rate 0.000440
Mean train iou loss for epoch 14: 0.9513
Mean train IoU for epoch 14: 0.0684
Inner Epoch 15
Learning rate 0.000352
Mean train iou loss for epoch 15: 0.9459
Mean train IoU for epoch 15: 0.0776
Inner Epoch 16
Learning rate 0.000281
Mean train iou loss for epoch 16: 0.9384
Mean train IoU for epoch 16: 0.0941
Inner Epoch 17
Learning rate 0.000225
Mean train iou loss for epoch 17: 0.9383
Mean train IoU for epoch 17: 0.0968
Inner Epoch 18
Learning rate 0.000180
Mean train iou loss for epoch 18: 0.9352
Mean train IoU for epoch 18: 0.1078
Inner Epoch 19
Learning rate 0.000144
Mean train iou loss for epoch 19: 0.9296
Mean train IoU for epoch 19: 0.1240
Validating... on val dataset: 5 shots
Val loss: 0.9088, val IoU: 0.2346
Dataset 14, vessel
Inner Epoch 0
Learning rate 0.010000
Mean train iou loss for epoch 0: 0.9945
Mean train IoU for epoch 0: 0.0002
Inner Epoch 1
Learning rate 0.008000
Mean train iou loss for epoch 1: 0.9922
Mean train IoU for epoch 1: 0.0101
Inner Epoch 2
Learning rate 0.006400
Mean train iou loss for epoch 2: 0.9912
Mean train IoU for epoch 2: 0.0085
Inner Epoch 3
Learning rate 0.005120
Mean train iou loss for epoch 3: 0.9878
Mean train IoU for epoch 3: 0.0137
Inner Epoch 4
Learning rate 0.004096
Mean train iou loss for epoch 4: 0.9862
Mean train IoU for epoch 4: 0.0148
Inner Epoch 5
Learning rate 0.003277
Mean train iou loss for epoch 5: 0.9840
Mean train IoU for epoch 5: 0.0186
Inner Epoch 6
Learning rate 0.002621
Mean train iou loss for epoch 6: 0.9817
Mean train IoU for epoch 6: 0.0231
Inner Epoch 7
Learning rate 0.002097
Mean train iou loss for epoch 7: 0.9786
Mean train IoU for epoch 7: 0.0278
Inner Epoch 8
Learning rate 0.001678
Mean train iou loss for epoch 8: 0.9751
Mean train IoU for epoch 8: 0.0340
Inner Epoch 9
Learning rate 0.001342
Mean train iou loss for epoch 9: 0.9718
Mean train IoU for epoch 9: 0.0414
Inner Epoch 10
Learning rate 0.001074
Mean train iou loss for epoch 10: 0.9687
Mean train IoU for epoch 10: 0.0436
Inner Epoch 11
Learning rate 0.000859
Mean train iou loss for epoch 11: 0.9667
Mean train IoU for epoch 11: 0.0471
Inner Epoch 12
Learning rate 0.000687
Mean train iou loss for epoch 12: 0.9641
Mean train IoU for epoch 12: 0.0489
Inner Epoch 13
Learning rate 0.000550
Mean train iou loss for epoch 13: 0.9594
Mean train IoU for epoch 13: 0.0562
Inner Epoch 14
Learning rate 0.000440
Mean train iou loss for epoch 14: 0.9600
Mean train IoU for epoch 14: 0.0657
Inner Epoch 15
Learning rate 0.000352
Mean train iou loss for epoch 15: 0.9641
Mean train IoU for epoch 15: 0.0536
Inner Epoch 16
Learning rate 0.000281
Mean train iou loss for epoch 16: 0.9553
Mean train IoU for epoch 16: 0.0776
Inner Epoch 17
Learning rate 0.000225
Mean train iou loss for epoch 17: 0.9538
Mean train IoU for epoch 17: 0.0609
Inner Epoch 18
Learning rate 0.000180
Mean train iou loss for epoch 18: 0.9524
Mean train IoU for epoch 18: 0.0609
Inner Epoch 19
Learning rate 0.000144
Mean train iou loss for epoch 19: 0.9500
Mean train IoU for epoch 19: 0.0665
Validating... on val dataset: 5 shots
Val loss: 0.9568, val IoU: 0.0525
Mean val loss: 0.8054, mean val IoU: 0.2346
Mean train iou loss in epoch 0: 0.7770
Mean train IoU in epoch 0: 0.2617
Validating... on val dataset: 5 shots
Evaluating hippocampus_anterior:
iou loss: 0.9096, IoU: 0.1403
Evaluating pancreas_cancer:
iou loss: 0.9945, IoU: 0.0036
Evaluating hippocampus_anterior:
iou loss: 0.8948, IoU: 0.1904
Evaluating vessel:
iou loss: 0.9946, IoU: 0.0017
Evaluating vessel:
iou loss: 0.9935, IoU: 0.0028
Mean meta validation iou loss: 0.5766
Mean meta validation IoU: 0.0393
One epoch took 2.533539228886366 minutes. Remaining time: 506.70784577727323 minutes
OUTER EPOCH 1
Dataset 17, lung
Inner Epoch 0
Learning rate 0.010000
Mean train iou loss for epoch 0: 0.9935
Mean train IoU for epoch 0: 0.0020
Inner Epoch 1
Learning rate 0.008000
Mean train iou loss for epoch 1: 0.9923
Mean train IoU for epoch 1: 0.0077
Inner Epoch 2
Learning rate 0.006400
Mean train iou loss for epoch 2: 0.9894
Mean train IoU for epoch 2: 0.0102
Inner Epoch 3
Learning rate 0.005120
Mean train iou loss for epoch 3: 0.9877
Mean train IoU for epoch 3: 0.0169
Inner Epoch 4
Learning rate 0.004096
Mean train iou loss for epoch 4: 0.9859
Mean train IoU for epoch 4: 0.0172
Inner Epoch 5
Learning rate 0.003277
Mean train iou loss for epoch 5: 0.9847
Mean train IoU for epoch 5: 0.0181
Inner Epoch 6
Learning rate 0.002621
Mean train iou loss for epoch 6: 0.9832
Mean train IoU for epoch 6: 0.0192
Inner Epoch 7
Learning rate 0.002097
Mean train iou loss for epoch 7: 0.9815
Mean train IoU for epoch 7: 0.0203
Inner Epoch 8
Learning rate 0.001678
Mean train iou loss for epoch 8: 0.9801
Mean train IoU for epoch 8: 0.0212
Inner Epoch 9
Learning rate 0.001342
Mean train iou loss for epoch 9: 0.9784
Mean train IoU for epoch 9: 0.0291
Inner Epoch 10
Learning rate 0.001074
Mean train iou loss for epoch 10: 0.9751
Mean train IoU for epoch 10: 0.0354
Inner Epoch 11
Learning rate 0.000859
Mean train iou loss for epoch 11: 0.9725
Mean train IoU for epoch 11: 0.0417
Inner Epoch 12
Learning rate 0.000687
Mean train iou loss for epoch 12: 0.9725
Mean train IoU for epoch 12: 0.0605
Inner Epoch 13
Learning rate 0.000550
Mean train iou loss for epoch 13: 0.9678
Mean train IoU for epoch 13: 0.0662
Inner Epoch 14
Learning rate 0.000440
Mean train iou loss for epoch 14: 0.9645
Mean train IoU for epoch 14: 0.0997
Inner Epoch 15
Learning rate 0.000352
Mean train iou loss for epoch 15: 0.9600
Mean train IoU for epoch 15: 0.1095
Inner Epoch 16
Learning rate 0.000281
Mean train iou loss for epoch 16: 0.9555
Mean train IoU for epoch 16: 0.1235
Inner Epoch 17
Learning rate 0.000225
Mean train iou loss for epoch 17: 0.9517
Mean train IoU for epoch 17: 0.1901
Inner Epoch 18
Learning rate 0.000180
Mean train iou loss for epoch 18: 0.9476
Mean train IoU for epoch 18: 0.1625
Inner Epoch 19
Learning rate 0.000144
Mean train iou loss for epoch 19: 0.9442
Mean train IoU for epoch 19: 0.1893
Validating... on val dataset: 5 shots
Val loss: 0.9392, val IoU: 0.2202
Dataset 11, hippocampus_anterior
Inner Epoch 0
Learning rate 0.010000
Mean train iou loss for epoch 0: 0.8924
Mean train IoU for epoch 0: 0.1867
Inner Epoch 1
Learning rate 0.008000
Mean train iou loss for epoch 1: 0.8828
Mean train IoU for epoch 1: 0.1314
Inner Epoch 2
Learning rate 0.006400
Mean train iou loss for epoch 2: 0.8563
Mean train IoU for epoch 2: 0.1484
Inner Epoch 3
Learning rate 0.005120
Mean train iou loss for epoch 3: 0.8369
Mean train IoU for epoch 3: 0.1652
Inner Epoch 4
Learning rate 0.004096
Traceback (most recent call last):
  File "experiment_runner.py", line 239, in <module>
    target_name=data.get("weights_name"))
  File "experiment_runner.py", line 51, in meta_train
    reptile.outer_loop(evaluate_every=4, path_to_save=save_path)
  File "/scratch2/mganesh/MetaMedSeg/MetaMedSeg/meta_learning/reptile.py", line 286, in outer_loop
    task_weights, loss_history, iou_history, task_val_loss, task_val_iou = self.inner_loop(dataset_id)
  File "/scratch2/mganesh/MetaMedSeg/MetaMedSeg/meta_learning/reptile.py", line 427, in inner_loop
    output, _ = model(image)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/scratch2/mganesh/MetaMedSeg/MetaMedSeg/networks/r2unet.py", line 313, in forward
    d3 = self.Up3(d4)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/scratch2/mganesh/MetaMedSeg/MetaMedSeg/networks/r2unet.py", line 54, in forward
    x = self.up(x)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 460, in _conv_forward
    self.padding, self.dilation, self.groups)
KeyboardInterrupt