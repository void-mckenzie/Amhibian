{'epochs': 20, 'batch_size': 1, 'ft_shots': 15, 'lr': 0.001, 'wd': 3e-05, 'loss_type': 'dice', 'scheduler': None, 'scheduler_params': None, 'norm_type': 'instance', 'volumetric': False, 'max_images': None, 'data_regime': 'all'}
Starting fine-tuning
Save path None
/scratch2/mganesh/MetaMedSeg/MetaMedSeg/splits/spleen
Using dice
Creating data loaders for fine-tuning
Training on all train data
Loaded pre-trained meta-model
Epoch 0
Learning rate 0.001000
/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
Mean train dice loss for epoch 0: 0.4846
Mean train IoU for epoch 0: 0.4267
Mean validation dice loss in epoch 0: 0.3090
Mean validation IoU in epoch 0: 0.5765
Epoch completed in 1.57 minutes. Remaining time (approx): 31.40 minutes
Epoch 1
Learning rate 0.001000
Mean train dice loss for epoch 1: 0.2079
Mean train IoU for epoch 1: 0.6963
Epoch completed in 1.03 minutes. Remaining time (approx): 19.59 minutes
Epoch 2
Learning rate 0.001000
Mean train dice loss for epoch 2: 0.1525
Mean train IoU for epoch 2: 0.7672
Mean validation dice loss in epoch 2: 0.1554
Mean validation IoU in epoch 2: 0.7620
Epoch completed in 1.02 minutes. Remaining time (approx): 18.31 minutes
Epoch 3
Learning rate 0.001000
Mean train dice loss for epoch 3: 0.1229
Mean train IoU for epoch 3: 0.8065
Epoch completed in 0.99 minutes. Remaining time (approx): 16.91 minutes
Epoch 4
Learning rate 0.001000
Mean train dice loss for epoch 4: 0.0976
Mean train IoU for epoch 4: 0.8412
Mean validation dice loss in epoch 4: 0.1397
Mean validation IoU in epoch 4: 0.7784
Epoch completed in 1.17 minutes. Remaining time (approx): 18.78 minutes
Epoch 5
Learning rate 0.001000
Mean train dice loss for epoch 5: 0.0947
Mean train IoU for epoch 5: 0.8446
Epoch completed in 1.02 minutes. Remaining time (approx): 15.26 minutes
Epoch 6
Learning rate 0.001000
Mean train dice loss for epoch 6: 0.0732
Mean train IoU for epoch 6: 0.8764
Mean validation dice loss in epoch 6: 0.0890
Mean validation IoU in epoch 6: 0.8543
Epoch completed in 1.19 minutes. Remaining time (approx): 16.60 minutes
Epoch 7
Learning rate 0.001000
Mean train dice loss for epoch 7: 0.0859
Mean train IoU for epoch 7: 0.8574
Epoch completed in 1.12 minutes. Remaining time (approx): 14.61 minutes
Epoch 8
Learning rate 0.001000
Mean train dice loss for epoch 8: 0.0670
Mean train IoU for epoch 8: 0.8855
Mean validation dice loss in epoch 8: 0.0864
Mean validation IoU in epoch 8: 0.8605
Epoch completed in 1.41 minutes. Remaining time (approx): 16.89 minutes
Epoch 9
Learning rate 0.001000
Mean train dice loss for epoch 9: 0.0743
Mean train IoU for epoch 9: 0.8745
Epoch completed in 0.66 minutes. Remaining time (approx): 7.30 minutes
Epoch 10
Learning rate 0.001000
Mean train dice loss for epoch 10: 0.0664
Mean train IoU for epoch 10: 0.8863
Mean validation dice loss in epoch 10: 0.0709
Mean validation IoU in epoch 10: 0.8811
Epoch completed in 0.24 minutes. Remaining time (approx): 2.41 minutes
Epoch 11
Learning rate 0.001000
Mean train dice loss for epoch 11: 0.0655
Mean train IoU for epoch 11: 0.8876
Epoch completed in 0.20 minutes. Remaining time (approx): 1.81 minutes
Epoch 12
Learning rate 0.001000
Mean train dice loss for epoch 12: 0.0582
Mean train IoU for epoch 12: 0.8980
Mean validation dice loss in epoch 12: 0.0700
Mean validation IoU in epoch 12: 0.8808
Epoch completed in 0.60 minutes. Remaining time (approx): 4.79 minutes
Epoch 13
Learning rate 0.001000
Mean train dice loss for epoch 13: 0.0522
Mean train IoU for epoch 13: 0.9077
Epoch completed in 1.17 minutes. Remaining time (approx): 8.20 minutes
Epoch 14
Learning rate 0.001000
Mean train dice loss for epoch 14: 0.0561
Mean train IoU for epoch 14: 0.9023
Mean validation dice loss in epoch 14: 0.0672
Mean validation IoU in epoch 14: 0.8856
Epoch completed in 1.32 minutes. Remaining time (approx): 7.92 minutes
Epoch 15
Learning rate 0.001000
Mean train dice loss for epoch 15: 0.0522
Mean train IoU for epoch 15: 0.9077
Epoch completed in 1.23 minutes. Remaining time (approx): 6.17 minutes
Epoch 16
Learning rate 0.001000
Mean train dice loss for epoch 16: 0.0637
Mean train IoU for epoch 16: 0.8893
Mean validation dice loss in epoch 16: 0.0804
Mean validation IoU in epoch 16: 0.8635
Epoch completed in 0.99 minutes. Remaining time (approx): 3.98 minutes
Epoch 17
Learning rate 0.001000
Mean train dice loss for epoch 17: 0.0460
Mean train IoU for epoch 17: 0.9175
Epoch completed in 1.19 minutes. Remaining time (approx): 3.58 minutes
Epoch 18
Learning rate 0.001000
Mean train dice loss for epoch 18: 0.0551
Mean train IoU for epoch 18: 0.9028
Mean validation dice loss in epoch 18: 0.0717
Mean validation IoU in epoch 18: 0.8745
Epoch completed in 1.11 minutes. Remaining time (approx): 2.23 minutes
Epoch 19
Learning rate 0.001000
Mean train dice loss for epoch 19: 0.0488
Mean train IoU for epoch 19: 0.9134
Mean validation dice loss in epoch 19: 0.0722
Mean validation IoU in epoch 19: 0.8759
Epoch completed in 1.22 minutes. Remaining time (approx): 1.22 minutes
Test dice loss: 0.07177394931086428
Test IoU: 0.8750856518745422
Fine_tuning completed in 1251.7962858001702 seconds.
                                            weights      target exp_type  ...      test_iou      elapsed              test_iou_all
0       experiments/weights_nonvolumetric_plain.pth  ['spleen']       ft  ...  8.712103e-01   170.132557      [0.8712103366851807]
1       experiments/weights_nonvolumetric_plain.pth  ['spleen']       ft  ...  1.417359e-07  2177.062495  [1.4173585327625915e-07]
2     experiments/weights_nonvolumetric_attunet.pth  ['spleen']       ft  ...  6.389144e-01   996.555175      [0.6389144062995911]
3  experiments/weights_nonvolumetric_plain_dice.pth    [spleen]       ft  ...  8.750857e-01  1251.796286      [0.8750856518745422]
[4 rows x 23 columns]