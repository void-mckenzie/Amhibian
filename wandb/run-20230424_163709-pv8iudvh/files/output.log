{'epochs': 20, 'batch_size': 1, 'ft_shots': 15, 'lr': 0.001, 'wd': 3e-05, 'loss_type': 'iou', 'scheduler': None, 'scheduler_params': None, 'norm_type': 'instance', 'volumetric': False, 'max_images': None, 'data_regime': 'all'}
Starting fine-tuning
Save path None
/scratch2/mganesh/MetaMedSeg/MetaMedSeg/splits/spleen
Using iou
Creating data loaders for fine-tuning
Training on all train data
Traceback (most recent call last):
  File "experiment_runner.py", line 235, in <module>
    num_selections=data.get("num_selections"), save_pth=save_path)
  File "experiment_runner.py", line 127, in fine_tune
    data_regime=data_regime, save_pth=save_pth))
  File "experiment_runner.py", line 95, in fine_tune_one_selection
    trainer.train_and_evaluate_all()
  File "/scratch2/mganesh/MetaMedSeg/MetaMedSeg/meta_learning/fine_tuning.py", line 244, in train_and_evaluate_all
    model = self.train(train_loader, val_loader, evaluate_every, name)
  File "/scratch2/mganesh/MetaMedSeg/MetaMedSeg/meta_learning/fine_tuning.py", line 134, in train
    model, optimizer, lr_scheduler = self.setup_model()
  File "/scratch2/mganesh/MetaMedSeg/MetaMedSeg/meta_learning/fine_tuning.py", line 217, in setup_model
    model.load_state_dict(self.init_weights)
  File "/home1/mganesh/miniconda3/envs/medseg/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1672, in load_state_dict
    self.__class__.__name__, "\n\t".join(error_msgs)))
RuntimeError: Error(s) in loading state_dict for UNet_Cells:
	Missing key(s) in state_dict: "dconv_down1.0.weight", "dconv_down1.0.bias", "dconv_down1.3.weight", "dconv_down1.3.bias", "dconv_down2.0.weight", "dconv_down2.0.bias", "dconv_down2.3.weight", "dconv_down2.3.bias", "dconv_down3.0.weight", "dconv_down3.0.bias", "dconv_down3.3.weight", "dconv_down3.3.bias", "dconv_up2.0.weight", "dconv_up2.0.bias", "dconv_up2.3.weight", "dconv_up2.3.bias", "dconv_up1.0.weight", "dconv_up1.0.bias", "dconv_up1.3.weight", "dconv_up1.3.bias", "conv_last.weight", "conv_last.bias".
	Unexpected key(s) in state_dict: "RRCNN1.RCNN.0.conv.0.weight", "RRCNN1.RCNN.0.conv.0.bias", "RRCNN1.RCNN.0.conv.1.weight", "RRCNN1.RCNN.0.conv.1.bias", "RRCNN1.RCNN.0.conv.1.running_mean", "RRCNN1.RCNN.0.conv.1.running_var", "RRCNN1.RCNN.0.conv.1.num_batches_tracked", "RRCNN1.RCNN.1.conv.0.weight", "RRCNN1.RCNN.1.conv.0.bias", "RRCNN1.RCNN.1.conv.1.weight", "RRCNN1.RCNN.1.conv.1.bias", "RRCNN1.RCNN.1.conv.1.running_mean", "RRCNN1.RCNN.1.conv.1.running_var", "RRCNN1.RCNN.1.conv.1.num_batches_tracked", "RRCNN1.Conv_1x1.weight", "RRCNN1.Conv_1x1.bias", "RRCNN2.RCNN.0.conv.0.weight", "RRCNN2.RCNN.0.conv.0.bias", "RRCNN2.RCNN.0.conv.1.weight", "RRCNN2.RCNN.0.conv.1.bias", "RRCNN2.RCNN.0.conv.1.running_mean", "RRCNN2.RCNN.0.conv.1.running_var", "RRCNN2.RCNN.0.conv.1.num_batches_tracked", "RRCNN2.RCNN.1.conv.0.weight", "RRCNN2.RCNN.1.conv.0.bias", "RRCNN2.RCNN.1.conv.1.weight", "RRCNN2.RCNN.1.conv.1.bias", "RRCNN2.RCNN.1.conv.1.running_mean", "RRCNN2.RCNN.1.conv.1.running_var", "RRCNN2.RCNN.1.conv.1.num_batches_tracked", "RRCNN2.Conv_1x1.weight", "RRCNN2.Conv_1x1.bias", "RRCNN3.RCNN.0.conv.0.weight", "RRCNN3.RCNN.0.conv.0.bias", "RRCNN3.RCNN.0.conv.1.weight", "RRCNN3.RCNN.0.conv.1.bias", "RRCNN3.RCNN.0.conv.1.running_mean", "RRCNN3.RCNN.0.conv.1.running_var", "RRCNN3.RCNN.0.conv.1.num_batches_tracked", "RRCNN3.RCNN.1.conv.0.weight", "RRCNN3.RCNN.1.conv.0.bias", "RRCNN3.RCNN.1.conv.1.weight", "RRCNN3.RCNN.1.conv.1.bias", "RRCNN3.RCNN.1.conv.1.running_mean", "RRCNN3.RCNN.1.conv.1.running_var", "RRCNN3.RCNN.1.conv.1.num_batches_tracked", "RRCNN3.Conv_1x1.weight", "RRCNN3.Conv_1x1.bias", "RRCNN4.RCNN.0.conv.0.weight", "RRCNN4.RCNN.0.conv.0.bias", "RRCNN4.RCNN.0.conv.1.weight", "RRCNN4.RCNN.0.conv.1.bias", "RRCNN4.RCNN.0.conv.1.running_mean", "RRCNN4.RCNN.0.conv.1.running_var", "RRCNN4.RCNN.0.conv.1.num_batches_tracked", "RRCNN4.RCNN.1.conv.0.weight", "RRCNN4.RCNN.1.conv.0.bias", "RRCNN4.RCNN.1.conv.1.weight", "RRCNN4.RCNN.1.conv.1.bias", "RRCNN4.RCNN.1.conv.1.running_mean", "RRCNN4.RCNN.1.conv.1.running_var", "RRCNN4.RCNN.1.conv.1.num_batches_tracked", "RRCNN4.Conv_1x1.weight", "RRCNN4.Conv_1x1.bias", "RRCNN5.RCNN.0.conv.0.weight", "RRCNN5.RCNN.0.conv.0.bias", "RRCNN5.RCNN.0.conv.1.weight", "RRCNN5.RCNN.0.conv.1.bias", "RRCNN5.RCNN.0.conv.1.running_mean", "RRCNN5.RCNN.0.conv.1.running_var", "RRCNN5.RCNN.0.conv.1.num_batches_tracked", "RRCNN5.RCNN.1.conv.0.weight", "RRCNN5.RCNN.1.conv.0.bias", "RRCNN5.RCNN.1.conv.1.weight", "RRCNN5.RCNN.1.conv.1.bias", "RRCNN5.RCNN.1.conv.1.running_mean", "RRCNN5.RCNN.1.conv.1.running_var", "RRCNN5.RCNN.1.conv.1.num_batches_tracked", "RRCNN5.Conv_1x1.weight", "RRCNN5.Conv_1x1.bias", "Up5.up.1.weight", "Up5.up.1.bias", "Up5.up.2.weight", "Up5.up.2.bias", "Up5.up.2.running_mean", "Up5.up.2.running_var", "Up5.up.2.num_batches_tracked", "Up_RRCNN5.RCNN.0.conv.0.weight", "Up_RRCNN5.RCNN.0.conv.0.bias", "Up_RRCNN5.RCNN.0.conv.1.weight", "Up_RRCNN5.RCNN.0.conv.1.bias", "Up_RRCNN5.RCNN.0.conv.1.running_mean", "Up_RRCNN5.RCNN.0.conv.1.running_var", "Up_RRCNN5.RCNN.0.conv.1.num_batches_tracked", "Up_RRCNN5.RCNN.1.conv.0.weight", "Up_RRCNN5.RCNN.1.conv.0.bias", "Up_RRCNN5.RCNN.1.conv.1.weight", "Up_RRCNN5.RCNN.1.conv.1.bias", "Up_RRCNN5.RCNN.1.conv.1.running_mean", "Up_RRCNN5.RCNN.1.conv.1.running_var", "Up_RRCNN5.RCNN.1.conv.1.num_batches_tracked", "Up_RRCNN5.Conv_1x1.weight", "Up_RRCNN5.Conv_1x1.bias", "Up4.up.1.weight", "Up4.up.1.bias", "Up4.up.2.weight", "Up4.up.2.bias", "Up4.up.2.running_mean", "Up4.up.2.running_var", "Up4.up.2.num_batches_tracked", "Up_RRCNN4.RCNN.0.conv.0.weight", "Up_RRCNN4.RCNN.0.conv.0.bias", "Up_RRCNN4.RCNN.0.conv.1.weight", "Up_RRCNN4.RCNN.0.conv.1.bias", "Up_RRCNN4.RCNN.0.conv.1.running_mean", "Up_RRCNN4.RCNN.0.conv.1.running_var", "Up_RRCNN4.RCNN.0.conv.1.num_batches_tracked", "Up_RRCNN4.RCNN.1.conv.0.weight", "Up_RRCNN4.RCNN.1.conv.0.bias", "Up_RRCNN4.RCNN.1.conv.1.weight", "Up_RRCNN4.RCNN.1.conv.1.bias", "Up_RRCNN4.RCNN.1.conv.1.running_mean", "Up_RRCNN4.RCNN.1.conv.1.running_var", "Up_RRCNN4.RCNN.1.conv.1.num_batches_tracked", "Up_RRCNN4.Conv_1x1.weight", "Up_RRCNN4.Conv_1x1.bias", "Up3.up.1.weight", "Up3.up.1.bias", "Up3.up.2.weight", "Up3.up.2.bias", "Up3.up.2.running_mean", "Up3.up.2.running_var", "Up3.up.2.num_batches_tracked", "Up_RRCNN3.RCNN.0.conv.0.weight", "Up_RRCNN3.RCNN.0.conv.0.bias", "Up_RRCNN3.RCNN.0.conv.1.weight", "Up_RRCNN3.RCNN.0.conv.1.bias", "Up_RRCNN3.RCNN.0.conv.1.running_mean", "Up_RRCNN3.RCNN.0.conv.1.running_var", "Up_RRCNN3.RCNN.0.conv.1.num_batches_tracked", "Up_RRCNN3.RCNN.1.conv.0.weight", "Up_RRCNN3.RCNN.1.conv.0.bias", "Up_RRCNN3.RCNN.1.conv.1.weight", "Up_RRCNN3.RCNN.1.conv.1.bias", "Up_RRCNN3.RCNN.1.conv.1.running_mean", "Up_RRCNN3.RCNN.1.conv.1.running_var", "Up_RRCNN3.RCNN.1.conv.1.num_batches_tracked", "Up_RRCNN3.Conv_1x1.weight", "Up_RRCNN3.Conv_1x1.bias", "Up2.up.1.weight", "Up2.up.1.bias", "Up2.up.2.weight", "Up2.up.2.bias", "Up2.up.2.running_mean", "Up2.up.2.running_var", "Up2.up.2.num_batches_tracked", "Up_RRCNN2.RCNN.0.conv.0.weight", "Up_RRCNN2.RCNN.0.conv.0.bias", "Up_RRCNN2.RCNN.0.conv.1.weight", "Up_RRCNN2.RCNN.0.conv.1.bias", "Up_RRCNN2.RCNN.0.conv.1.running_mean", "Up_RRCNN2.RCNN.0.conv.1.running_var", "Up_RRCNN2.RCNN.0.conv.1.num_batches_tracked", "Up_RRCNN2.RCNN.1.conv.0.weight", "Up_RRCNN2.RCNN.1.conv.0.bias", "Up_RRCNN2.RCNN.1.conv.1.weight", "Up_RRCNN2.RCNN.1.conv.1.bias", "Up_RRCNN2.RCNN.1.conv.1.running_mean", "Up_RRCNN2.RCNN.1.conv.1.running_var", "Up_RRCNN2.RCNN.1.conv.1.num_batches_tracked", "Up_RRCNN2.Conv_1x1.weight", "Up_RRCNN2.Conv_1x1.bias", "Conv_1x1.weight", "Conv_1x1.bias".