{'epochs': 20, 'batch_size': 1, 'ft_shots': 15, 'lr': 0.001, 'wd': 3e-05, 'loss_type': 'iou', 'scheduler': None, 'scheduler_params': None, 'norm_type': 'instance', 'volumetric': False, 'max_images': None, 'data_regime': 'all'}
Starting fine-tuning
Save path None
/scratch2/mganesh/MetaMedSeg/MetaMedSeg/splits/spleen
Using iou
Creating data loaders for fine-tuning
Training on all train data
Loaded pre-trained meta-model
Epoch 0
Learning rate 0.001000
Mean train iou loss for epoch 0: 0.9565
Mean train IoU for epoch 0: 0.0437
Mean validation iou loss in epoch 0: 0.9962
Mean validation IoU in epoch 0: 0.0000
Epoch completed in 2.01 minutes. Remaining time (approx): 40.21 minutes
Epoch 1
Learning rate 0.001000
Mean train iou loss for epoch 1: 0.4482
Mean train IoU for epoch 1: 0.5565
Epoch completed in 1.69 minutes. Remaining time (approx): 32.16 minutes
Epoch 2
Learning rate 0.001000
Mean train iou loss for epoch 2: 0.3047
Mean train IoU for epoch 2: 0.6980
Mean validation iou loss in epoch 2: 0.9997
Mean validation IoU in epoch 2: 0.0000
Epoch completed in 1.69 minutes. Remaining time (approx): 30.47 minutes
Epoch 3
Learning rate 0.001000
Mean train iou loss for epoch 3: 0.2426
Mean train IoU for epoch 3: 0.7593
Epoch completed in 1.71 minutes. Remaining time (approx): 28.99 minutes
Epoch 4
Learning rate 0.001000
Mean train iou loss for epoch 4: 0.1966
Mean train IoU for epoch 4: 0.8050
Mean validation iou loss in epoch 4: 0.9986
Mean validation IoU in epoch 4: 0.0000
Epoch completed in 1.76 minutes. Remaining time (approx): 28.11 minutes
Epoch 5
Learning rate 0.001000
Mean train iou loss for epoch 5: 0.1937
Mean train IoU for epoch 5: 0.8076
Epoch completed in 1.61 minutes. Remaining time (approx): 24.19 minutes
Epoch 6
Learning rate 0.001000
Mean train iou loss for epoch 6: 0.1503
Mean train IoU for epoch 6: 0.8506
Mean validation iou loss in epoch 6: 0.9994
Mean validation IoU in epoch 6: 0.0000
Epoch completed in 1.84 minutes. Remaining time (approx): 25.77 minutes
Epoch 7
Learning rate 0.001000
Mean train iou loss for epoch 7: 0.1482
Mean train IoU for epoch 7: 0.8529
Epoch completed in 1.65 minutes. Remaining time (approx): 21.41 minutes
Epoch 8
Learning rate 0.001000
Mean train iou loss for epoch 8: 0.1828
Mean train IoU for epoch 8: 0.8184
Mean validation iou loss in epoch 8: 0.9986
Mean validation IoU in epoch 8: 0.0000
Epoch completed in 1.89 minutes. Remaining time (approx): 22.63 minutes
Epoch 9
Learning rate 0.001000
Mean train iou loss for epoch 9: 0.1189
Mean train IoU for epoch 9: 0.8820
Epoch completed in 1.65 minutes. Remaining time (approx): 18.20 minutes
Epoch 10
Learning rate 0.001000
Mean train iou loss for epoch 10: 0.1263
Mean train IoU for epoch 10: 0.8743
Mean validation iou loss in epoch 10: 0.9986
Mean validation IoU in epoch 10: 0.0000
Epoch completed in 1.86 minutes. Remaining time (approx): 18.58 minutes
Epoch 11
Learning rate 0.001000
Mean train iou loss for epoch 11: 0.1177
Mean train IoU for epoch 11: 0.8828
Epoch completed in 1.75 minutes. Remaining time (approx): 15.72 minutes
Epoch 12
Learning rate 0.001000
Mean train iou loss for epoch 12: 0.1355
Mean train IoU for epoch 12: 0.8651
Mean validation iou loss in epoch 12: 0.9986
Mean validation IoU in epoch 12: 0.0000
Epoch completed in 1.85 minutes. Remaining time (approx): 14.76 minutes
Epoch 13
Learning rate 0.001000
Mean train iou loss for epoch 13: 0.1042
Mean train IoU for epoch 13: 0.8961
Epoch completed in 1.83 minutes. Remaining time (approx): 12.79 minutes
Epoch 14
Learning rate 0.001000
Mean train iou loss for epoch 14: 0.1371
Mean train IoU for epoch 14: 0.8636
Mean validation iou loss in epoch 14: 0.9986
Mean validation IoU in epoch 14: 0.0000
Epoch completed in 1.86 minutes. Remaining time (approx): 11.16 minutes
Epoch 15
Learning rate 0.001000
Mean train iou loss for epoch 15: 0.0932
Mean train IoU for epoch 15: 0.9071
Epoch completed in 1.68 minutes. Remaining time (approx): 8.38 minutes
Epoch 16
Learning rate 0.001000
Mean train iou loss for epoch 16: 0.1019
Mean train IoU for epoch 16: 0.8987
Mean validation iou loss in epoch 16: 0.9986
Mean validation IoU in epoch 16: 0.0000
Epoch completed in 1.87 minutes. Remaining time (approx): 7.47 minutes
Epoch 17
Learning rate 0.001000
Mean train iou loss for epoch 17: 0.1002
Mean train IoU for epoch 17: 0.9003
Epoch completed in 1.90 minutes. Remaining time (approx): 5.69 minutes
Epoch 18
Learning rate 0.001000
Mean train iou loss for epoch 18: 0.0981
Mean train IoU for epoch 18: 0.9023
Mean validation iou loss in epoch 18: 0.9986
Mean validation IoU in epoch 18: 0.0000
Epoch completed in 1.80 minutes. Remaining time (approx): 3.59 minutes
Epoch 19
Learning rate 0.001000
Mean train iou loss for epoch 19: 0.1012
Mean train IoU for epoch 19: 0.8992
Mean validation iou loss in epoch 19: 0.9986
Mean validation IoU in epoch 19: 0.0000
Epoch completed in 1.99 minutes. Remaining time (approx): 1.99 minutes
Test iou loss: 0.9985858250390455
Test IoU: 1.4173585327625915e-07
Fine_tuning completed in 2177.0624954360537 seconds.
                                       weights  ...              test_iou_all
0  experiments/weights_nonvolumetric_plain.pth  ...      [0.8712103366851807]
1  experiments/weights_nonvolumetric_plain.pth  ...  [1.4173585327625915e-07]
[2 rows x 23 columns]